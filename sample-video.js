import fs from "fs";
import path from "path";

// This script creates a minimal valid MP4 file for testing purposes
// The file will be very small (a few KB) but valid for upload testing

// MP4 file header and minimal structure (hexadecimal)
const mp4Header = Buffer.from([
  // File Type Box (ftyp)
  0x00, 0x00, 0x00, 0x18, 0x66, 0x74, 0x79, 0x70, 0x69, 0x73, 0x6f, 0x6d, 0x00,
  0x00, 0x00, 0x01, 0x69, 0x73, 0x6f, 0x6d, 0x61, 0x76, 0x63, 0x31,

  // Movie Box (moov) - simplified
  0x00, 0x00, 0x00, 0x60, 0x6d, 0x6f, 0x6f, 0x76, 0x00, 0x00, 0x00, 0x6c, 0x6d,
  0x76, 0x68, 0x64, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x03, 0xe8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
  0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00,

  // Media Data Box (mdat) - minimal content
  0x00, 0x00, 0x00, 0x10, 0x6d, 0x64, 0x61, 0x74, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00,
]);

// Create the sample video file
const outputPath = path.join(process.cwd(), "sample-video.mp4");

try {
  fs.writeFileSync(outputPath, mp4Header);
  console.log(`Sample video created at: ${outputPath}`);
  console.log("File size:", fs.statSync(outputPath).size, "bytes");
  console.log("You can now upload this file to test your application.");
} catch (error) {
  console.error("Error creating sample video:", error);
}
